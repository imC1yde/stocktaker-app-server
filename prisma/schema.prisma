generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URI")
}

// ------------------------------------------------
// USER
// ------------------------------------------------
model User {
  id           String  @id @unique @default(uuid())
  username     String?
  profileImage String?
  email        String  @unique
  password     String

  items Item[] @relation(name: "user-items")

  games Game[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedUt DateTime @updatedAt @map("updated_at")

  @@map("users")
}

// ------------------------------------------------
// CUSTOM CATALOG
// ------------------------------------------------
model Item {
  id String @id @unique @default(uuid())

  name        String
  image       String
  description String?

  user   User?   @relation(name: "user-items", fields: [userId], references: [id])
  userId String? @map("user_id")

  createdAt DateTime @default(now()) @map("created_at")
  updatedUt DateTime @updatedAt @map("updated_at")

  @@map("items")
}

// ------------------------------------------------
// GAME CATALOG
// ------------------------------------------------
model Game {
  id Int @id @default(autoincrement())

  rawgId          Int      @unique @map("rawg_id")
  name            String
  slug            String
  description     String
  backgroundImage String   @map("background_image")
  rating          Float
  released        DateTime
  playtime        Float

  esrbRatings EsrbRating[]

  genres Genre[]

  platforms Platform[]

  users User[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedUt DateTime @updatedAt @map("updated_at")

  @@index([rawgId, slug, rating])
  @@map("games")
}

model EsrbRating {
  id Int @id @default(autoincrement())

  name String
  slug String

  games Game[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedUt DateTime @updatedAt @map("updated_at")

  @@index([slug])
  @@map("esrb_rating")
}

model Genre {
  id Int @id @default(autoincrement())

  name String
  slug String

  game Game[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedUt DateTime @updatedAt @map("updated_at")

  @@index([slug])
  @@map("genres")
}

model Platform {
  id Int @id @default(autoincrement())

  name String
  slug String

  game Game[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedUt DateTime @updatedAt @map("updated_at")

  @@index([slug])
  @@map("platforms")
}
