generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URI")
}

// ---------------- USER --------------------
model User {
  id           String  @id @db.Uuid @unique @default(uuid())
  username     String?
  profileImage String?
  email        String  @unique
  password     String

  items Item[] @relation(name: "user-items")

  games GameInventory[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedUt DateTime @updatedAt @map("updated_at")

  @@map("users")
}

// ---------------- CUSTOM INVENTORY --------------------
model Item {
  id String @id @unique @default(uuid())

  name        String
  image       String
  description String?

  user   User?   @relation(name: "user-items", fields: [userId], references: [id])
  userId String? @db.Uuid @map("user_id")

  createdAt DateTime @default(now()) @map("created_at")
  updatedUt DateTime @updatedAt @map("updated_at")

  @@map("items")
}

// ---------------- GAME INVENTORY --------------------
model Game {
  id String @id @db.Uuid() @unique @default(uuid())

  rawgId          Int       @unique @map("rawg_id")
  name            String
  slug            String
  description     String?   @db.Text
  backgroundImage String?   @map("background_image")
  rating          Float     @default(0)
  released        DateTime?
  esrbRating      String?
  genres          String[]  @default([])
  platforms       String[]  @default([])

  users GameInventory[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@index([rating])
  @@map("games")
}

model GameInventory {
  userId String @db.Uuid @map("user_id")
  gameId String @db.Uuid @map("game_id")

  user User @relation(fields: [userId], references: [id])
  game Game @relation(fields: [gameId], references: [id])

  isCompleted Boolean @default(false)

  @@id([gameId, userId])
  @@map("game_inventories")
}
